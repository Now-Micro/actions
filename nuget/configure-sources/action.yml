name: "Configure Nuget Source"
description: "Configures NuGet to use one or more sources"
inputs:
  names:
    description: "Comma-separated names of the NuGet sources"
    required: true
  passwords:
    description: "Comma-separated Personal Access Tokens for authentication"
    required: true
  urls:
    description: "Comma-separated URLs of the NuGet feeds"
    required: true
  usernames:
    description: "Comma-separated usernames for source authentication"
    required: true
  degug-mode:
    description: "Enable verbose debug logging (true/false)"
    required: false
    default: "false"

runs:
  using: "composite"
  steps:
    - name: Set up Node.js
      uses: Now-Micro/actions/setup-node@v1

    - name: Validate and Expand Inputs
      id: validate
      shell: bash
      run: node "$GITHUB_ACTION_PATH/validate-and-export.js"
      env:
        INPUT_NAMES: ${{ inputs.names }}
        INPUT_USERNAMES: ${{ inputs.usernames }}
        INPUT_PASSWORDS: ${{ inputs.passwords }}
        INPUT_URLS: ${{ inputs.urls }}
        INPUT_DEGUG_MODE: ${{ inputs.degug-mode }}

    - name: Configure NuGet authentication for each source
      if: steps.validate.outputs.count != '0'
      shell: bash
      run: node "$GITHUB_ACTION_PATH/configure-sources.js"
      env:
        INPUT_NAMES: ${{ steps.validate.outputs.names }}
        INPUT_USERNAMES: ${{ steps.validate.outputs.usernames }}
        INPUT_PASSWORDS: ${{ steps.validate.outputs.passwords }}
        INPUT_URLS: ${{ steps.validate.outputs.urls }}
        INPUT_DEGUG_MODE: ${{ inputs.degug-mode }}
